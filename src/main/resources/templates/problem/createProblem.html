<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Create Problem</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css"
    />
    <link rel="stylesheet" th:href="@{/css/createproblemStyle.css}" />

  </head>
  <body>
    <div class="container">
      <h2>Create Problem</h2>
      <div class="input-box">
        <!-- <form th:action="@{/problem/addProblem}" method="post" id="problemForm"> -->
        <form  id="problemForm">
          <label for="title">Title:</label>
          <input type="text" id="title" name="title" required />
          <br>
          <label for="statement">Statement:</label>
          <textarea id="statement" name="statement"></textarea>
          <br>
          <label for="language">Language:</label>
          <input type="text" id="language" name="language" required />
          <br>
          <label for="difficulty">Difficulty:</label>
          <select id="difficulty" name="difficulty" required>
            <option value="EASY">Easy</option>
            <option value="NORMAL">Normal</option>
            <option value="HARD">Hard</option>
          </select>
          <br>
          <label for="timeLimit">Time Limit (ms):</label>
          <input type="number" id="timeLimit" name="timeLimit" required />
          <br>
          <label for="memoryLimit">Memory Limit (KB):</label>
          <input type="number" id="memoryLimit" name="memoryLimit" required />
          <br>
          <div id="testCasesContainer"></div>
          <button type="button" class="create-button" id="addTestCaseButton">Add Test Case</button>
          <button type="submit" class="create-button">Create Problem</button>
        </form>
      </div>

    <script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>
    <script>
      var easyMDE = new EasyMDE({
        element: document.getElementById("statement"),
      });
      let inputs = []
      let outputs = []

      document.getElementById('addTestCaseButton').addEventListener('click', function() {
        var testCasesContainer = document.getElementById('testCasesContainer');

        var testCaseDiv = document.createElement('div');
        testCaseDiv.classList.add('input-box');

        var inputLabel = document.createElement('label');
        inputLabel.textContent = 'Input:';
        testCaseDiv.appendChild(inputLabel);

        var inputBox = document.createElement('input');
        inputBox.type = 'text';
        inputBox.required = true;
        testCaseDiv.appendChild(inputBox);
        inputs.push(inputBox)

        var outputLabel = document.createElement('label');
        outputLabel.textContent = 'Output:';
        testCaseDiv.appendChild(outputLabel);

        var outputBox = document.createElement('input');
        outputBox.type = 'text';
        outputBox.required = true;
        testCaseDiv.appendChild(outputBox);
        outputs.push(outputBox)

        testCasesContainer.appendChild(testCaseDiv);
      });
      document.getElementById('problemForm').addEventListener('submit', function(event) {
        event.preventDefault();

        let formData = new FormData(document.getElementById('problemForm'));

        let formObject = {};
        formData.forEach((value, key) => formObject[key] = value);
        formObject.testCases = []
        for(let i = 0; i < inputs.length; i++){
          formObject.testCases.push({input : inputs[i].value | "", output : outputs[i].value | ""})
        }


        debugger
        fetch('/api/problem', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(formObject),
        })
        .then(response => response.json())
        .then(data => {
          console.log('Success:', data);
          // Handle success
        })
        .catch(error => {
          console.error('Error:', error);
          // Handle error
        });
      });
    </script>

  </body>
</html>
